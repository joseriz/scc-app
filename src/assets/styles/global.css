/* Mobile-first styles with better responsiveness */
.notation-editor {
    max-width: 100%;
    padding: 10px;
    overflow-x: hidden;
    box-sizing: border-box;
  }
  
  /* Responsive controls */
  .controls {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 15px;
    width: 100%;
  }
  
  .controls-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
    width: 100%;
  }
  
  .tempo-control {
    flex: 1;
    min-width: 120px;
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 5px;
  }
  
  .tempo-control label {
    white-space: nowrap;
    font-size: 14px;
  }
  
  .tempo-slider {
    width: 100%;
    max-width: 200px;
  }
  
  .clef-selector {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .clef-selector label {
    font-weight: 500;
    white-space: nowrap;
  }
  
  .custom-select {
    position: relative;
    min-width: 120px;
  }
  
  .custom-select select {
    appearance: none;
    background-color: white;
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 8px 30px 8px 10px;
    width: 100%;
    font-size: 15px;
    cursor: pointer;
    outline: none;
    transition: all 0.2s ease;
  }
  
  .custom-select select:hover {
    border-color: #2196F3;
  }
  
  .custom-select select:focus {
    border-color: #2196F3;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
  }
  
  .custom-select .select-icon {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    font-size: 10px;
    color: #666;
  }
  
  /* Enhance select options (works in some browsers) */
  .custom-select select option {
    padding: 10px;
    font-size: 15px;
  }
  
  /* Media query for mobile */
  @media (max-width: 600px) {
    .custom-select {
      min-width: 100px;
    }
    
    .custom-select select {
      padding: 6px 25px 6px 8px;
      font-size: 14px;
    }
  }
  
  .playback-controls {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin: 10px 0;
  }
  
  .action-button {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    position: relative;
    overflow: hidden;
  }
  
  .action-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    box-shadow: none;
  }
  
  /* Add ripple effect */
  .action-button::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 120%;
    height: 120%;
    background: rgba(255,255,255,0.3);
    border-radius: 50%;
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
    transition: all 0.3s ease;
  }
  
  .action-button:active:not(:disabled)::after {
    transform: translate(-50%, -50%) scale(1.5);
    opacity: 1;
    transition: all 0.2s ease;
  }
  
  .button-icon {
    font-size: 18px;
    line-height: 1;
  }
  
  .button-label {
    font-weight: 500;
  }
  
  .play-button {
    background-color: #4CAF50;
    color: white;
  }
  
  .play-button:hover:not(:disabled) {
    background-color: #45a049;
    transform: translateY(-2px);
  }
  
  .stop-button {
    background-color: #f44336;
    color: white;
  }
  
  .stop-button:hover:not(:disabled) {
    background-color: #e53935;
    transform: translateY(-2px);
  }
  
  .clear-button {
    background-color: #757575;
    color: white;
  }
  
  .clear-button:hover:not(:disabled) {
    background-color: #616161;
    transform: translateY(-2px);
  }
  
  /* Button press animation */
  @keyframes buttonPress {
    0% { transform: scale(1); }
    50% { transform: scale(0.95); }
    100% { transform: scale(1); }
  }
  
  .button-press-animation {
    animation: buttonPress 0.3s ease;
  }
  
  /* Mobile tabs with better sizing */
  .mobile-tabs {
    display: flex;
    margin: 10px 0;
    width: 100%;
  }
  
  .tab-btn {
    flex: 1;
    padding: 10px 5px;
    background: #f0f0f0;
    border: none;
    border-bottom: 2px solid #ddd;
    font-weight: bold;
    font-size: 14px;
    white-space: nowrap;
  }
  
  /* Note controls container with better sizing */
  .note-controls-container, .settings-container {
    background: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 4px;
    padding: 10px;
    margin-bottom: 10px;
    width: 100%;
    box-sizing: border-box;
  }
  
  .control-section {
    margin-bottom: 15px;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #f9f9f9;
  }
  
  .control-section h4 {
    margin-top: 0;
    margin-bottom: 8px;
    color: #333;
    font-size: 14px;
    text-align: center;
    border-bottom: 1px solid #eee;
    padding-bottom: 5px;
  }
  
  /* Improve button spacing and appearance */
  .scrollable-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 5px;
  }
  
  .note-btn {
    flex: 0 0 auto;
    min-width: 40px;
    height: 40px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: white;
    font-size: 18px;
    line-height: 1;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .note-btn.active {
    background: #2196F3;
    color: white;
    border-color: #0d8aee;
    box-shadow: 0 0 5px rgba(33, 150, 243, 0.5);
  }
  
  /* Style dotted note toggle more prominently */
  .dotted-note-toggle {
    margin-top: 8px;
    display: flex;
    justify-content: center;
  }
  
  .dotted-note-toggle button {
    width: 100%;
    max-width: 120px;
    height: 36px;
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 14px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .dotted-note-toggle button.active {
    background: #2196F3;
    box-shadow: 0 0 5px rgba(33, 150, 243, 0.5);
  }
  
  .button-group {
    display: flex;
    gap: 5px;
    width: 100%;
  }
  
  .button-group button {
    flex: 1;
  }
  
  /* Responsive buttons */
  .note-btn, .octave-btn, .chord-btn, .extend-btn {
    padding: 8px;
    border: none;
    border-radius: 4px;
    background: #4CAF50;
    color: white;
    cursor: pointer;
    white-space: nowrap;
    font-size: 14px;
    min-width: 40px;
    text-align: center;
  }
  
  /* Staff scroll controls with better positioning */
  .staff-scroll-controls {
    position: absolute;
    bottom: 10px;
    right: 10px;
    display: flex;
    gap: 5px;
    z-index: 10;
  }
  
  .scroll-btn {
    width: 36px;
    height: 36px;
    background: rgba(33, 150, 243, 0.7);
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .extend-btn {
    padding: 0 10px;
    height: 36px;
    background: rgba(76, 175, 80, 0.7);
    color: white;
    border: none;
    border-radius: 18px;
    font-size: 12px;
    cursor: pointer;
    white-space: nowrap;
  }
  
  /* Responsive adjustments for different screen sizes */
  @media (max-width: 360px) {
    /* Extra small screens */
    .notation-editor {
      padding: 5px;
    }
    
    .tempo-control label {
      font-size: 12px;
    }
    
    .tab-btn {
      padding: 8px 5px;
      font-size: 12px;
    }
    
    .note-btn, .octave-btn, .chord-btn {
      padding: 6px;
      font-size: 12px;
      min-width: 30px;
    }
    
    .scroll-btn {
      width: 30px;
      height: 30px;
    }
    
    .extend-btn {
      padding: 0 8px;
      height: 30px;
      font-size: 11px;
    }
  }
  
  @media (min-width: 768px) {
    /* Larger screens */
    .notation-editor {
      padding: 20px;
    }
    
    .controls {
      flex-direction: row;
      align-items: center;
    }
    
    .mobile-tabs {
      display: none;
    }
    
    .note-controls-container, .settings-container {
      display: block !important;
    }
    
    .note-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    
    .control-section {
      flex: 1;
      min-width: 150px;
    }
    
    .scrollable-buttons {
      flex-wrap: wrap;
    }
    
    .staff-container {
    height: 300px;
    }
    
    .scroll-btn {
      width: 40px;
      height: 40px;
    }
    
    .extend-btn {
      padding: 0 15px;
      height: 40px;
      font-size: 14px;
    }
  }
  
  /* Keep other existing styles */
  .clef {
    width: 60px;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    border-right: 1px solid #ddd;
  }
  
  .clef img {
    height: 150px;
    width: auto;
    margin-left: 5px;
    margin-top: -10px;
    object-fit: contain;
  }
  
  .staff-scroll-container {
    flex: 1;
    position: relative;
    overflow: hidden;
    width: calc(100% - 60px); /* Subtract clef width */
  }
  
  /* Add these styles for better drag behavior */
  .staff {
    position: absolute;
    height: 100%;
    padding-top: 60px;
    transition: transform 0.1s ease;
    min-width: 100%;
    cursor: grab;
  }
  
  .staff:active {
    cursor: grabbing;
    transition: none; /* Disable transition during active dragging for better responsiveness */
  }
  
  .staff-lines {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 60px;
    z-index: 1;
  }
  
  .staff-line {
    position: absolute;
    width: 100%;
    height: 1px;
    background-color: black;
    left: 0;
  }
  
  /* Make sure the staff lines are positioned correctly */
  .staff-line:nth-child(1) { top: 100px; }
  .staff-line:nth-child(2) { top: 115px; }
  .staff-line:nth-child(3) { top: 130px; }
  .staff-line:nth-child(4) { top: 145px; }
  .staff-line:nth-child(5) { top: 160px; }
  
  .note-controls {
    display: flex;
    gap: 5px;
    padding: 10px;
    background: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  
  .note-btn {
    padding: 8px 12px;
    border: none;
    border-radius: 4px;
    background: #4CAF50;
    color: white;
    cursor: pointer;
  }
  
  .note-btn.active {
    background: #2196F3;
  }
  
  .octave-range {
    margin-top: 10px;
    padding: 10px;
    background: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  
  .octave-buttons {
    display: flex;
    gap: 5px;
    margin-top: 5px;
  }
  
  .octave-btn {
    padding: 5px 10px;
    border: none;
    border-radius: 4px;
    background: #4CAF50;
    color: white;
    cursor: pointer;
  }
  
  .octave-btn.active {
    background: #2196F3;
  }
  
  .debug-panel {
    margin-top: 20px;
    padding: 15px;
    background: #e3f2fd;
    border: 1px solid #2196F3;
    border-radius: 4px;
  }
  
  .debug-controls {
    display: flex;
    gap: 20px;
    margin: 10px 0;
  }
  
  .debug-btn {
    padding: 8px 12px;
    border: none;
    border-radius: 4px;
    background: #ff5722;
    color: white;
    cursor: pointer;
    margin-top: 5px;
  }
  
  .debug-btn.active {
    background: #9c27b0;
  }
  
  .debug-hint {
    font-style: italic;
    color: #666;
    margin-top: 10px;
  }
  
  button {
    transition: all 0.2s;
  }
  
  button:hover {
    opacity: 0.9;
  }
  
  .play-btn { background: #4CAF50; }
  .stop-btn { background: #f44336; }
  .clear-btn { background: #ff9800; }
  
  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .notes-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 3;
    overflow: visible;
  }
  
  .note {
    position: absolute;
    font-family: 'Bravura', sans-serif; /* Ensure Bravura font is used */
    font-size: 3.5em; /* Default size for noteheads */
    cursor: pointer;
    user-select: none;
    transition: transform 0.1s ease-out, background-color 0.2s;
    display: flex; /* Use flexbox for alignment */
    align-items: center; /* Center items vertically */
    justify-content: center; /* Center items horizontally */
    width: 30px; /* Give notes some width */
    height: 20px; /* Give notes some height */
    transform: translate(-50%, -50%); /* Center based on element size */
    margin-bottom: 0; /* Remove the previous margin */
  }
  
  /* Increase size specifically for rests */
  .note.rest {
    font-size: 4.5em; /* Make rests larger */
    /* Adjust vertical position slightly if needed */
    /* top: calc(50% - 5px); */ /* Example adjustment */
  }
  
  .note.playing {
    background-color: rgba(255, 255, 0, 0.3); /* Highlight playing note */
    transform: translate(-50%, -50%) scale(1.1); /* Slightly larger when playing */
  }
  
  /* Notehead styles */
  .notehead {
    position: absolute;
    width: 10px;
    height: 8px;
    background: black;
    border-radius: 50%;
    left: 5px;
    top: 16px;
    transform: rotate(-20deg);
  }
  
  /* Styles for whole and half notes */
  .notehead.whole, .notehead.half {
    background: white;
    border: 1px solid black;
  }
  
  /* Specific styles for whole notes */
  .notehead.whole {
    width: 12px;
    height: 8px;
    left: 4px;
  }
  
  /* Remove stem for whole notes */
  .note[data-duration="whole"] .stem,
  .note[data-duration="whole"] .flag {
    display: none;
  }
  
  /* Ensure whole notes are properly centered */
  .note[data-duration="whole"] {
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Adjust dot position for whole notes */
  .note[data-duration="whole"] .dot {
    right: -12px;
    top: 2px;
  }
  
  /* Remove redundant styles */
  /* Removing .whole-note .notehead.whole and .whole-note .stem as they're redundant */
  
  /* For whole and half notes, use hollow noteheads */
  .notehead.half {
    background: white;
    border: 1px solid black;
    height: 7px;
  }
  
  /* Special styling for whole notes */
  .whole-note .notehead.whole {
    width: 12px;
    height: 8px;
    border: 1px solid black;
    background: white;
    border-radius: 50%;
    transform: rotate(-20deg);
    left: 4px;
    top: 16px;
  }
  
  /* Make sure whole notes don't have stems */
  .whole-note .stem {
    display: none;
  }
  
  /* Adjust dot position for whole notes */
  .whole-note .dot {
    right: -12px;
    top: 16px;
  }
  
  /* Stem styles */
  .stem {
    position: absolute;
    width: 1px;
    height: 30px; /* Standard stem length */
    background: black;
  }
  
  .stem.up {
    /* Stem goes up from the right side of the notehead */
    bottom: 19px; /* Align with notehead center */
    right: 5px; /* Position relative to note container */
  }
  
  .stem.down {
    /* Stem goes down from the left side of the notehead */
    top: 19px; /* Align with notehead center */
    left: 5px; /* Position relative to note container */
  }
  
  /* --- Remove Previous Flag Styles --- */
  /* Delete the .flag, .flag::before, .flag::after rules added previously */

  /* --- Add New CSS Flag Styles (Skewed Rectangles) --- */
  .flag {
    position: absolute;
    width: 0;
    height: 0;
    pointer-events: none;
  }

  /* Position the flag container at the end of the stem */
  .flag.up {
    bottom: 49px; /* End of the upward stem */
    right: 5px; /* Align with stem */
  }
  .flag.down {
    top: 49px; /* End of the downward stem */
    left: 5px; /* Align with stem */
  }

  /* Style for the first flag (::before) - using a skewed rectangle */
  .flag::before {
    content: '';
    position: absolute;
    width: 14px; /* Width of the flag */
    height: 8px; /* Thickness/height of the flag */
    background-color: black;
    border-radius: 0 0 4px 4px; /* Slightly rounded bottom corners */
    transform-origin: top left; /* Skew from the connection point */
  }

  /* Style for the second flag (::after) - only for sixteenth */
  .flag.sixteenth::after {
    content: '';
    position: absolute;
    width: 14px; /* Match first flag */
    height: 8px; /* Match first flag */
    background-color: black;
    border-radius: 0 0 4px 4px; /* Match first flag */
    transform-origin: top left; /* Match first flag */
  }

  /* Positioning and skew for UP stem flags */
  .flag.up::before {
    bottom: -4px; /* Overlap stem end slightly */
    left: 0px; /* Connect to stem */
    transform: skewY(35deg); /* Skew downwards */
  }
  .flag.up.sixteenth::after {
    bottom: -11px; /* Position below the first flag */
    left: 0px; /* Align with first flag */
    transform: skewY(35deg); /* Match slant */
  }

  /* Positioning and style adjustments for DOWN stem flags */
  .flag.down::before,
  .flag.down.sixteenth::after {
    border-radius: 4px 4px 0 0; /* Slightly rounded top corners */
    transform-origin: bottom right; /* Skew from the connection point */
  }

  .flag.down::before {
    top: -4px; /* Overlap stem end slightly */
    right: 0px; /* Connect to stem */
    transform: skewY(-35deg); /* Skew upwards */
  }
  .flag.down.sixteenth::after {
    top: -11px; /* Position above the first flag */
    right: 0px; /* Align with first flag */
    transform: skewY(-35deg); /* Match slant */
  }

  /* Accidental positioning */
  .accidental {
    position: absolute;
    left: -12px;
    top: 8px;
    font-size: 18px;
  }
  
  /* Add stem direction classes */
  .note[data-stem="up"] {
    transform: translate(-50%, -50%);
  }
  
  .note[data-stem="down"] {
    transform: translate(-50%, -50%) rotate(180deg);
  }
  
  /* Adjust accidental positioning for stem direction */
  .note[data-stem="up"] .accidental {
    left: -12px;
    top: 0;
    transform: none;
  }
  
  .note[data-stem="down"] .accidental {
    left: 12px;
    top: 0;
    transform: rotate(180deg);
  }
  
  /* Chord symbol styles */
  .chord-symbol {
    position: absolute;
    font-family: 'Times New Roman', serif;
    font-size: 16px;
    font-weight: bold;
    transform: translateX(-50%);
    z-index: 4;
    color: #333;
  }
  
  .chord-controls {
    margin: 10px 0;
    display: flex;
    gap: 10px;
  }
  
  .chord-btn {
    background-color: #4a6da7;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  
  .chord-btn:hover {
    background-color: #3a5d97;
  }
  
  .chord-input-modal {
    position: absolute;
    background: white;
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 15px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    z-index: 10;
  }
  
  .modal-header {
    font-weight: bold;
    margin-bottom: 10px;
  }
  
  .chord-input-modal input {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  
  .modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }
  
  .add-btn {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  
  .cancel-btn {
    background-color: #f44336;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  
  /* Key signature styles */
  .key-signature {
    position: absolute;
    top: 0;
    left: 40px; /* Position right after the clef */
    height: 100%;
    z-index: 2;
  }
  
  .key-signature-accidental {
    position: absolute;
    font-size: 24px;
    line-height: 0;
    transform: translate(-50%, -50%); /* Center the accidental on its position */
    font-family: 'Times New Roman', serif; /* Better for music notation */
  }
  
  .key-signature-control {
    display: flex;
    align-items: center;
    margin-left: 20px;
  }
  
  .key-signature-control label {
    margin-right: 10px;
  }
  
  .key-signature-control select {
    padding: 5px;
    border-radius: 4px;
    border: 1px solid #ccc;
  }
  
  .note.key-signature-affected {
    color: #2196F3;
  }
  
  /* Restore the missing staff container styles */
  .staff-container {
    border: 1px solid #ddd;
    background: white;
    margin: 10px 0;
    display: flex;
    height: 300px;
    position: relative;
    overflow: hidden;
    margin-bottom: 30px;
    padding-bottom: 20px;
  }
  
  /* Restore tab button active styles */
  .tab-btn.active {
    background: #fff;
    border-bottom: 2px solid #2196F3;
    color: #2196F3;
  }
  
  /* Restore active button styles */
  .note-btn.active, .octave-btn.active {
    background: #2196F3;
  }
  
  /* Restore hover effects */
  .extend-btn:hover {
    background: rgba(76, 175, 80, 0.9);
  }
  
  .scroll-btn:hover {
    background: rgba(33, 150, 243, 0.9);
  }
  
  /* Restore measure bar styles */
  .measure-bar {
    position: absolute;
    top: 100px;
    width: 1px;
    height: 60px;
    background: black;
    z-index: 2;
  }
  
  /* Restore ledger line styles */
  .ledger-lines-container {
    position: absolute;
    z-index: 2;
    pointer-events: none; /* Allow clicking through to the note */
  }
  
  .ledger-line {
    position: absolute;
    height: 1px;
    background-color: black;
    z-index: 2;
    width: 20px;
  }
  
  /* Ensure ledger lines are visible for all note types */
  .ledger-line.above, .ledger-line.below {
    display: block;
    width: 20px;
    opacity: 1;
    visibility: visible;
  }
  
  /* Adjust ledger line positioning for whole notes */
  .note[data-duration="whole"] + .ledger-lines-container {
    transform: none;
  }
  
  /* Make ledger lines slightly wider for whole notes */
  .note[data-duration="whole"] ~ .ledger-lines-container .ledger-line {
    width: 24px; /* Slightly wider to match the whole note */
    left: -12px; /* Center the wider ledger line */
  }
  
  /* Remove any transform that might be affecting ledger lines */
  .ledger-lines-container.above,
  .ledger-lines-container.below {
    transform: none;
  }
  
  /* Add specific styles for bass clef ledger lines */
  .bass-clef-ledger-line {
    position: absolute;
    height: 1px;
    background-color: black;
    z-index: 2;
    width: 20px;
  }
  
  /* Restore bass clef specific adjustments */
  .clef img[alt="Bass Clef"] {
    height: 100px;
    width: auto;
    margin-top: 10px;
    margin-left: 0;
    transform: scale(0.7);
  }
  
  .dotted-note-toggle {
    display: flex;
    gap: 5px;
  }
  
  .dotted-note-toggle button {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    background: #4CAF50;
    color: white;
    cursor: pointer;
  }
  
  .dotted-note-toggle button.active {
    background: #2196F3;
  }
  
  .dot {
    font-size: 12px;
    margin-left: 5px;
  }
  
  /* Add styles for the dot */
  .dot {
    position: absolute;
    font-size: 16px;
    font-weight: bold;
    right: -10px;
    top: 8px;
  }
  
  /* Adjust dot position for stem direction */
  .note[data-stem="up"] .dot {
    right: -10px;
    top: 8px;
  }
  
  .note[data-stem="down"] .dot {
    left: -10px;
    bottom: 8px;
  }
  
  /* Update the dotted note toggle styles */
  .dotted-note-toggle {
    margin-top: 5px;
  }
  
  .dot-btn {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 6px 12px;
  }
  
  .dot-symbol {
    font-size: 18px;
    font-weight: bold;
    line-height: 1;
  }
  
  /* Make the active state more obvious */
  .dot-btn.active {
    background: #2196F3;
    box-shadow: 0 0 5px rgba(33, 150, 243, 0.5);
  }
  
  /* Update the dot styles for notes */
  .dot {
    position: absolute;
    font-size: 16px;
    font-weight: bold;
    right: -10px;
    top: 8px;
  }
  
  /* Adjust dot position for stem direction */
  .note[data-stem="up"] .dot {
    right: -10px;
    top: 8px;
  }
  
  .note[data-stem="down"] .dot {
    left: -10px;
    bottom: 8px;
  }
  
  /* Update ledger line styles for all note types */
  .ledger-lines-container {
    position: absolute;
    z-index: 2;
    pointer-events: none;
    width: 24px; /* Consistent width for all ledger lines */
  }
  
  .ledger-line {
    position: absolute;
    height: 1px;
    background-color: black;
    z-index: 2;
    width: 24px;
  }
  
  /* Position ledger lines relative to the note */
  .ledger-lines-container.above,
  .ledger-lines-container.below {
    left: -12px; /* Center the ledger lines */
    transform: none;
  }
  
  /* Ensure ledger lines are visible */
  .ledger-line.above,
  .ledger-line.below {
    display: block !important;
    opacity: 1;
    visibility: visible;
  }
  
  /* Specific positioning for ledger lines */
  .ledger-line:nth-child(1) { top: 0px; }
  .ledger-line:nth-child(2) { top: 15px; }
  .ledger-line:nth-child(3) { top: 30px; }
  .ledger-line:nth-child(4) { top: 45px; }
  .ledger-line:nth-child(5) { top: 60px; }
  
  /* Remove any transforms that might interfere */
  .note ~ .ledger-lines-container {
    transform: none !important;
  }
  
  /* Ensure proper z-index stacking */
  .note {
    z-index: 3;
  }
  
  .ledger-lines-container {
    z-index: 2;
  }
  
  /* Make sure ledger lines extend full width */
  .ledger-line {
    min-width: 24px;
    left: 0;
  }
  
  /* Add a visual indicator for right-click functionality */
  .note {
    position: absolute;
    transform: translate(-50%, -50%);
    z-index: 3;
    cursor: pointer;
    transition: all 0.2s;
    width: 20px;
    height: 40px;
  }
  
  .note:hover {
    filter: brightness(0.9);
  }
  
  .note:hover::after {
    content: '×';
    position: absolute;
    top: -15px;
    right: -15px;
    color: #f44336;
    font-size: 16px;
    font-weight: bold;
    opacity: 0.7;
    pointer-events: none;
  }
  
  /* Update the hover styles to only show on non-touch devices */
  @media (hover: hover) {
    .note:hover::after {
      content: '×';
      position: absolute;
      top: -15px;
      right: -15px;
      color: #f44336;
      font-size: 16px;
      font-weight: bold;
      opacity: 0.7;
      pointer-events: none;
    }
  }
  
  /* Add styles for touch feedback */
  .note.touch-active {
    opacity: 0.7;
  }
  
  /* Improved mobile note controls */
  .note-controls-container {
    padding: 10px;
    background: #f5f5f5;
    border-top: 1px solid #ddd;
  }
  
  .note-controls-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
  }
  
  /* Make control sections more compact */
  .control-section {
    margin-bottom: 10px;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #f9f9f9;
  }
  
  /* Smaller headers */
  .control-section h4 {
    margin-top: 0;
    margin-bottom: 5px;
    font-size: 12px;
    text-align: center;
    border-bottom: 1px solid #eee;
    padding-bottom: 3px;
  }
  
  /* Make buttons smaller and more touch-friendly */
  .note-btn, .octave-btn {
    flex: 0 0 auto;
    min-width: 36px;
    height: 36px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: white;
    font-size: 16px;
    line-height: 1;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  /* Ensure the scrollable buttons don't overflow */
  .scrollable-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 5px;
    max-height: none;
    overflow: visible;
  }
  
  /* Adjust button groups for the type section */
  .button-group {
    display: flex;
    gap: 5px;
    justify-content: center;
  }
  
  .button-group button {
    flex: 1;
  }
  
  /* Make sure octave buttons are always visible */
  .octave-section .scrollable-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
  }
  
  .octave-btn {
    flex: 0 0 calc(20% - 5px);
    margin: 0;
  }
  
  /* Ensure active state is clearly visible */
  .note-btn.active, .octave-btn.active {
    background: #2196F3;
    color: white;
    border-color: #0d8aee;
    box-shadow: 0 0 5px rgba(33, 150, 243, 0.5);
  }
  
  /* Mobile-specific adjustments */
  @media (max-width: 480px) {
    .note-controls-grid {
      grid-template-columns: 1fr 1fr;
    }
    
    .note-btn, .octave-btn {
      min-width: 32px;
      height: 32px;
      font-size: 14px;
    }
    
    .octave-btn {
      min-width: 25px;
    }
  }
  
  /* Fix button icon visibility */
  .note-btn, .octave-btn {
    flex: 0 0 auto;
    min-width: 36px;
    height: 36px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background: white;
    color: #333; /* Ensure text is visible */
    font-size: 16px;
    font-weight: bold; /* Make text more visible */
    line-height: 1;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    text-shadow: none; /* Remove any text shadows */
    box-shadow: 0 1px 3px rgba(0,0,0,0.1); /* Add subtle shadow for depth */
  }
  
  /* Ensure button text is visible in all states */
  .note-btn:not(.active), .octave-btn:not(.active) {
    color: #333; /* Dark text on light background for contrast */
    background: #f7f7f7; /* Slightly off-white background */
    border-color: #ddd;
  }
  
  /* Style active state with higher contrast */
  .note-btn.active, .octave-btn.active {
    background: #2196F3;
    color: white;
    border-color: #0d8aee;
    box-shadow: 0 0 5px rgba(33, 150, 243, 0.5);
    font-weight: bold;
  }
  
  /* Add specific styles for duration buttons to ensure symbols are visible */
  .duration-section .note-btn {
    font-family: 'Times New Roman', serif; /* Better for music symbols */
    font-size: 20px; /* Larger for better visibility */
    font-weight: normal; /* Normal weight for symbols */
  }
  
  /* Add specific styles for accidental buttons */
  .accidental-section .note-btn {
    font-size: 18px;
    font-weight: normal;
  }
  
  /* Octave buttons should be very clear */
  .octave-section .octave-btn {
    font-weight: bold;
    font-size: 16px;
  }
  
  /* Add styles for saved compositions */
  .saved-compositions-container {
    margin-top: 20px;
    padding: 15px;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  
  .save-composition-form {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .save-btn {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  
  .no-saved-compositions {
    text-align: center;
    color: #666;
  }
  
  .saved-composition-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  
  .saved-composition-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px;
    background: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  
  .composition-info {
    display: flex;
    flex-direction: column;
  }
  
  .composition-name {
    font-weight: bold;
  }
  
  .composition-date {
    font-size: 12px;
    color: #666;
  }
  
  .composition-actions {
    display: flex;
    gap: 5px;
  }
  
  .load-btn, .delete-btn {
    background-color: #f44336;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  
  /* Styles for saved compositions */
  .saved-compositions-container {
    padding: 15px;
    background: #f5f5f5;
  }
  
  .save-composition-form {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
  }
  
  .composition-name-input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
  }
  
  .save-btn {
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 15px;
    cursor: pointer;
    font-weight: bold;
  }
  
  .save-btn:hover {
    background-color: #45a049;
  }
  
  .no-saved-compositions {
    text-align: center;
    padding: 20px;
    color: #666;
    font-style: italic;
  }
  
  .saved-composition-list {
    max-height: 300px;
    overflow-y: auto;
  }
  
  .saved-composition-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid #ddd;
    background: white;
    margin-bottom: 5px;
    border-radius: 4px;
  }
  
  .composition-info {
    display: flex;
    flex-direction: column;
  }
  
  .composition-name {
    font-weight: bold;
    color: #333;
  }
  
  .composition-date {
    font-size: 12px;
    color: #777;
  }
  
  .composition-actions {
    display: flex;
    gap: 5px;
  }
  
  .load-btn {
    background-color: #2196F3;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
  }
  
  .delete-btn {
    background-color: #f44336;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
  }
  
  /* Make tabs fit the new third option */
  .mobile-tabs {
    display: flex;
  }
  
  .mobile-tabs .tab-btn {
    flex: 1;
    padding: 10px;
    text-align: center;
    background: #f0f0f0;
    border: none;
    border-bottom: 2px solid transparent;
    cursor: pointer;
  }
  
  .mobile-tabs .tab-btn.active {
    background: white;
    border-bottom: 2px solid #2196F3;
    font-weight: bold;
  }
  
  /* Add CSS for force-redraw animation */
  .force-redraw {
    animation: flash 0.1s;
  }
  
  @keyframes flash {
    0% { opacity: 0.9; }
    100% { opacity: 1; }
  }
  
  /* Add styles for edit mode in saved compositions */
  .edit-name-form {
    display: flex;
    gap: 5px;
    margin-top: 5px;
  }
  
  .rename-input {
    flex: 1;
    padding: 4px 8px;
    border: 1px solid #2196F3;
    border-radius: 4px;
    font-size: 14px;
  }
  
  .save-rename-btn, .cancel-rename-btn {
    padding: 4px 8px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
  }
  
  .save-rename-btn {
    background-color: #4CAF50;
    color: white;
  }
  
  .cancel-rename-btn {
    background-color: #f44336;
    color: white;
  }
  
  /* Update button */
  .update-btn {
    background-color: #FF9800;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 5px 10px;
    cursor: pointer;
    margin-left: 5px;
  }
  
  /* Import/Export controls */
  .import-export-controls {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    margin-bottom: 15px;
    justify-content: center;
  }
  
  .export-btn, .import-btn {
    background-color: #3F51B5;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 15px;
    cursor: pointer;
    font-size: 14px;
    display: inline-block;
    text-align: center;
  }
  
  .export-btn:hover, .import-btn:hover {
    background-color: #303F9F;
  }
  
  .export-btn:disabled {
    background-color: #9E9E9E;
    cursor: not-allowed;
  }
  
  .action-btn {
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    background: #4CAF50;
    color: white;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .action-btn:hover {
    background-color: #45a049;
  }
  
  .btn-icon {
    font-size: 18px;
    font-weight: bold;
  }
  
  .btn-text {
    font-size: 14px;
    font-weight: normal;
  }
  
  .btn-disabled {
    background-color: #9E9E9E;
    cursor: not-allowed;
  }
  
  .custom-select {
    position: relative;
    display: inline-block;
  }
  
  .select-icon {
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    pointer-events: none;
    color: #999;
  }
  
  .select-icon::after {
    content: "\25BC";
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    pointer-events: none;
    color: #999;
  }
  
  .select-icon::before {
    content: "\25B2";
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    pointer-events: none;
    color: #999;
  }
  
  .select-icon::after,
  .select-icon::before {
    font-size: 12px;
    line-height: 1;
    pointer-events: none;
  }
  
  /* Time signature selector styles */
  .time-signature-selector {
    margin-top: 10px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  
  .time-signature-selector label {
    font-weight: 500;
    white-space: nowrap;
  }
  
  .custom-select select {
    appearance: none;
    background-color: white;
    border: 1px solid #ccc;
    border-radius: 6px;
    padding: 8px 30px 8px 10px;
    width: 100%;
    font-size: 15px;
    cursor: pointer;
    outline: none;
    transition: all 0.2s ease;
  }
  
  .custom-select select:hover {
    border-color: #2196F3;
  }
  
  .custom-select select:focus {
    border-color: #2196F3;
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
  }
  
  .custom-select .select-icon {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    font-size: 10px;
    color: #666;
  }
  
  /* Enhance select options (works in some browsers) */
  .custom-select select option {
    padding: 10px;
    font-size: 15px;
  }
  
  /* Media query for mobile */
  @media (max-width: 600px) {
    .custom-select {
      min-width: 100px;
    }
    
    .custom-select select {
      padding: 6px 25px 6px 8px;
      font-size: 14px;
    }
  }
  
  /* Add this inside the staff div, after the measure bars section */
  .time-signature-display {
    position: absolute;
    top: 100px;
    left: 70px;
    display: flex;
    gap: 5px;
    z-index: 5;
  }
  
  /* Add this inside the staff div, after the measure bars section */
  .time-signature-display .time-signature-numerator {
    font-size: 16px;
    font-weight: bold;
  }
  
  /* Add this inside the staff div, after the measure bars section */
  .time-signature-display .time-signature-denominator {
    font-size: 14px;
    color: #666;
  }
  
  /* Measure bars with proper musical implementation */
  .barline {
    position: absolute;
    top: 100px; /* Align exactly with the top staff line */
    width: 1px;
    height: 60px; /* Make sure it covers all 5 staff lines */
    background-color: #000;
    z-index: 2;
  }
  
  /* Ensure all barline types maintain proper alignment */
  .barline-single,
  .barline-double,
  .barline-final,
  .barline-repeat-start,
  .barline-repeat-end {
    top: 100px; /* Ensure consistent alignment for all barline types */
    height: 60px;
  }
  
  /* Add repeat dots for repeat barlines */
  .repeat-dots {
    position: absolute;
    top: 100px;
    left: 70px;
    display: flex;
    gap: 5px;
    z-index: 5;
  }
  
  /* Beat markers (optional, for visual aid) */
  .beat-marker {
    position: absolute;
    top: 100px;
    width: 1px;
    height: 60px;
    background: black;
    z-index: 2;
  }
  
  /* Barline styling */
  .barline-single {
    width: 1px;
  }
  
  .barline-double {
    width: 5px;
    position: relative;
  }
  
  .barline-double::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    width: 1px;
    height: 100%;
    background-color: #000;
  }
  
  .barline-double::after {
    content: "";
    position: absolute;
    right: 0;
    top: 0;
    width: 1px;
    height: 100%;
    background-color: #000;
  }
  
  .barline-final {
    width: 6px;
    position: relative;
  }
  
  .barline-final::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    width: 1px;
    height: 100%;
    background-color: #000;
  }
  
  .barline-final::after {
    content: "";
    position: absolute;
    right: 0;
    top: 0;
    width: 3px;
    height: 100%;
    background-color: #000;
  }
  
  .barline-repeat-start,
  .barline-repeat-end {
    width: 10px;
    position: relative;
  }
  
  .barline-repeat-start::before,
  .barline-repeat-end::before {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    width: 3px;
    height: 100%;
    background-color: #000;
  }
  
  .barline-repeat-start::after,
  .barline-repeat-end::after {
    content: "";
    position: absolute;
    right: 0;
    top: 0;
    width: 1px;
    height: 100%;
    background-color: #000;
  }
  
  .repeat-dots {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  
  /* Time signature display */
  .time-signature-display {
    position: absolute;
    top: 107px; /* Align with staff */
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 2;
  }
  
  .time-signature-numerator,
  .time-signature-denominator {
    font-size: 24px;
    font-weight: bold;
    line-height: 1;
  }
  
  /* Fix the time signature display positioning and styling */
  .time-signature-display {
    position: absolute;
    top: 110px; /* Align with staff */
    left: 70px; /* Position after clef */
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 3; /* Make sure it's above the staff lines */
    width: 20px;
    text-align: center;
  }
  
  .time-signature-numerator,
  .time-signature-denominator {
    font-size: 24px;
    font-weight: bold;
    line-height: 1;
    font-family: 'Times New Roman', serif; /* Better for music notation */
  }
  
  .time-signature-numerator {
    border-bottom: 1px solid transparent; /* Optional: adds spacing */
    margin-bottom: 2px;
  }
  
  /* Fix the time signature display positioning and styling */
  .time-signature-display {
    position: absolute;
    top: 110px; /* Align with staff */
    left: 70px; /* Position after clef */
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 3; /* Make sure it's above the staff lines */
    width: 20px;
    text-align: center;
  }
  
  .time-signature-numerator,
  .time-signature-denominator {
    font-size: 24px;
    font-weight: bold;
    line-height: 1;
    font-family: 'Times New Roman', serif; /* Better for music notation */
  }
  
  .time-signature-numerator {
    border-bottom: 1px solid transparent; /* Optional: adds spacing */
    margin-bottom: 2px;
  }
  
  /* Improved key signature styling */
  .key-signature {
    position: absolute;
    top: 0;
    left: 40px; /* Position right after the clef */
    height: 100%;
    z-index: 2;
  }
  
  .key-signature-accidental {
    position: absolute;
    font-size: 24px;
    line-height: 0;
    transform: translate(-50%, -50%); /* Center the accidental on its position */
    font-family: 'Times New Roman', serif; /* Better for music notation */
  }
  
  /* Add measure number styling */
  .measure-number {
    position: absolute;
    top: 75px; /* Position above the staff */
    left: -8px; /* Center with the barline */
    font-size: 12px;
    color: #666;
    font-weight: 500;
  }
  
  /* Option to only show measure numbers at regular intervals */
  .measure-number[data-interval="true"] {
    font-weight: bold;
    color: #333;
  }
  
  /* Add these styles for the playback measure controls */
  .playback-measure-controls {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 10px;
    padding: 10px;
    background-color: #f5f5f5;
    border-radius: 6px;
    border: 1px solid #ddd;
  }
  
  .control-label {
    font-weight: 500;
    color: #333;
    margin-bottom: 5px;
  }
  
  .measure-range-inputs {
    display: flex;
    gap: 15px;
    align-items: center;
  }
  
  .measure-input {
    display: flex;
    align-items: center;
    gap: 5px;
  }
  
  .measure-number-input {
    width: 60px;
    padding: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    text-align: center;
  }
  
  .measure-hint {
    font-size: 12px;
    color: #666;
    font-style: italic;
  }
  
  .auto-scroll-toggle {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-top: 5px;
  }
  
  .auto-scroll-toggle input[type="checkbox"] {
    margin: 0;
  }
  
  /* Make the controls responsive */
  @media (min-width: 768px) {
    .playback-measure-controls {
      flex-direction: row;
      align-items: center;
      gap: 20px;
    }
    
    .control-label {
      margin-bottom: 0;
      white-space: nowrap;
    }
    
    .auto-scroll-toggle {
      margin-top: 0;
      margin-left: auto;
    }
  }
  
  /* Add styles for the measure visibility toggle */
  .measure-visibility-toggle {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-top: 10px;
    margin-bottom: 10px;
  }
  
  .measure-visibility-toggle input[type="checkbox"] {
    margin: 0;
  }
  
  .measure-visibility-toggle label {
    font-size: 14px;
    color: #333;
  }
  
  /* Add styles for pause and resume buttons */
  .pause-button {
    background-color: #FF9800;
    color: white;
  }
  
  .pause-button:hover:not(:disabled) {
    background-color: #F57C00;
    transform: translateY(-2px);
  }
  
  .resume-button {
    background-color: #2196F3;
    color: white;
  }
  
  .resume-button:hover:not(:disabled) {
    background-color: #1976D2;
    transform: translateY(-2px);
  }
  
  /* Add styles for the restart button */
  .restart-button {
    background-color: #2196F3;
    color: white;
  }
  
  .restart-button:hover:not(:disabled) {
    background-color: #1976D2;
    transform: translateY(-2px);
  }
  
  /* Add styles for the note icons */
  .note-icon {
    width: 20px;
    height: 20px;
    display: inline-block;
    vertical-align: middle;
  }
  
  /* Ensure the buttons can accommodate the icons */
  .note-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 40px;
    min-height: 40px;
  }

  /* Consolidated barline styling with correct alignment */
  .barline {
    position: absolute;
    top: 100px; /* Align exactly with the top staff line */
    width: 1px; /* Default width for single barlines */
    height: 60px; /* Cover all 5 staff lines */
    background-color: #000;
    z-index: 2;
  }

  .barline-single {
    /* Single barline is the default */
  }

  .barline-double {
    width: 5px;
    position: relative;
  }

  /* Ensure the pseudo-elements also align properly */
  .barline-double::before,
  .barline-double::after,
  .barline-final::before,
  .barline-final::after,
  .barline-repeat-start::before,
  .barline-repeat-start::after,
  .barline-repeat-end::before,
  .barline-repeat-end::after {
    top: 0; /* Align with parent */
    height: 100%; /* Full height of parent */
  }

  /* Lyrics styling */
  .lyrics-control-section {
    margin-top: 15px;
    padding: 10px;
    background-color: #f0f7ff;
    border: 1px solid #cce5ff;
    border-radius: 6px;
  }

  .lyrics-input-container {
    display: flex;
    gap: 10px;
    margin-bottom: 8px;
  }

  .lyric-input {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
  }

  .add-lyric-btn {
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 12px;
    cursor: pointer;
    font-weight: bold;
  }

  .add-lyric-btn:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
  }

  .lyrics-help-text {
    font-size: 12px;
    color: #666;
    font-style: italic;
    margin-top: 5px;
  }

  /* Style for lyrics under notes */
  .lyric {
    position: absolute;
    left: 50%; /* Center horizontally relative to the note's position */
    transform: translateX(-50%);
    font-size: 14px;
    color: #333;
    font-family: 'Times New Roman', serif;
    white-space: nowrap;
    text-align: center;
    pointer-events: none;
    line-height: 1.2;
  }

  .lyric.playing {
    color: #f44336;
    font-weight: bold;
  }

  /* Ensure notes with lyrics have proper spacing */
  .note {
    margin-bottom: 0; /* Remove the previous margin */
  }

  /* Add a class for notes with lyrics to help with spacing */
  .note.has-lyric {
    /* No special styling needed here, just for selection */
  }

  /* Add some spacing for the new key signature selector */
  .key-signature-selector {
    display: flex;
    align-items: center;
    margin-left: 15px; /* Adjust spacing as needed */
  }

  .key-signature-selector label {
    margin-right: 5px;
    font-weight: bold;
  }

  /* Ensure custom select styles apply */
  .key-signature-selector .custom-select {
    position: relative;
    display: inline-block;
  }

  .key-signature-selector .custom-select select {
    /* Inherit styles from existing custom-select or define them */
    padding: 8px 25px 8px 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    background-color: white;
    cursor: pointer;
    appearance: none; /* Hide default arrow */
    -webkit-appearance: none;
    -moz-appearance: none;
    min-width: 120px; /* Adjust width */
  }

  .key-signature-selector .custom-select .select-icon {
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    pointer-events: none; /* Allow clicks to pass through to select */
  }

  /* Adjustments for smaller screens if needed */
  @media (max-width: 768px) {
    .key-signature-selector {
      margin-left: 10px; /* Reduce margin on smaller screens */
      margin-top: 5px; /* Add some top margin if needed */
    }
    .key-signature-selector .custom-select select {
       min-width: 100px; /* Slightly smaller width */
       padding: 6px 20px 6px 8px; /* Adjust padding */
    }
  }

  .note.selected {
    /* Add a distinct outline to the selected note */
    outline: 2px solid #2196F3; /* Blue outline */
    outline-offset: 3px; /* Space between note and outline */
    border-radius: 50%; /* Make outline rounded for noteheads */
    box-shadow: 0 0 8px rgba(33, 150, 243, 0.5); /* Optional subtle glow */
  }

  /* Ensure outline works for rests too */
  .note.rest.selected {
    outline: 2px solid #2196F3;
    outline-offset: 3px;
    border-radius: 4px; /* More rectangular outline for rests */
    box-shadow: 0 0 8px rgba(33, 150, 243, 0.5);
  }

  /* Add this to your <style> section */
.help-button-container {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 100;
}

.help-button {
  display: flex;
  align-items: center;
  gap: 8px;
  background-color: #2196F3;
  color: white;
  border: none;
  border-radius: 50px;
  padding: 8px 15px;
  cursor: pointer;
  font-weight: bold;
  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  transition: all 0.2s ease;
}

.help-button:hover {
  background-color: #1976D2;
  transform: translateY(-2px);
}

.help-icon {
  font-size: 18px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: white;
  color: #2196F3;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

.help-text {
  font-size: 14px;
}

/* Mobile adjustments */
@media (max-width: 600px) {
  .help-button {
    padding: 6px;
    border-radius: 50%;
  }
  
  .help-text {
    display: none;
  }
}
  /* Optional: Slightly adjust position if outline causes overlap issues */
  /* .note.selected {
    z-index: 10;
  } */